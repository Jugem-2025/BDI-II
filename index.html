<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>メモ帳</title>
  <style>
    /* ベースレイアウト */
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
      font-family: Arial, sans-serif;
    }

    header {
      background-color: #333;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }

    main {
      flex: 1;
      padding: 1rem;
    }

    /* 入力エリア */
    #memo-input {
      width: 100%;
      height: 12rem;
      padding: 0.5rem;
      font-size: 1rem;
      box-sizing: border-box;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
      margin-bottom: 1rem;
    }

    /* メモ一覧 */
    #memo-list {
      margin-top: 2rem;
    }

    #memo-list h2 {
      margin-bottom: 0.5rem;
    }

    #memo-list ul {
      list-style: none;
      padding: 0;
    }

    #memo-list li {
      padding: 0.75rem;
      border-bottom: 1px solid #eee;
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* フッター＋ボタン類 */
    footer {
      background-color: #f8f9fa;
      padding: 1rem;
      text-align: center;
    }

    #footer a.link-button,
    #footer button {
      display: inline-block;
      padding: 8px 16px;
      font-size: 1rem;
      margin-right: 8px;
      border: none;
      background-color: #17a2b8;
      color: #fff;
      border-radius: 4px;
      text-decoration: none;
      cursor: pointer;
    }

    #footer a.link-button:hover,
    #footer button:hover {
      background-color: #138496;
    }

    #footer a.link-button:focus,
    #footer button:focus {
      outline: 2px solid #005f6b;
      outline-offset: 2px;
    }
  </style>
</head>
<body>
  <header>
    <h1>メモ帳</h1>
  </header>

  <main>
    <!-- メモ入力 -->
    <textarea
      id="memo-input"
      placeholder="ここにメモを入力してください…"
      aria-label="メモ入力エリア"
    ></textarea>

    <!-- 保存済みメモ一覧 -->
    <section id="memo-list">
      <h2>メモ一覧</h2>
      <ul id="memos-ul"></ul>
    </section>
  </main>

  <footer id="footer">
    <div>
      <!-- ここで履歴ページへのリンクを追加 -->
      <a href="history.html" class="link-button" aria-label="保存履歴を見る">
        履歴を見る
      </a>
      <button id="save-btn" type="button">保存</button>
      <button id="clear-btn" type="button">クリア</button>
    </div>
  </footer>

  <script>
    // 要素取得
    const inputEl = document.getElementById('memo-input');
    const saveBtn = document.getElementById('save-btn');
    const clearBtn = document.getElementById('clear-btn');
    const memosUl = document.getElementById('memos-ul');

    // ローカルストレージからメモを読み込み、画面に描画
    function renderMemos() {
      const memos = JSON.parse(localStorage.getItem('memos')) || [];
      memosUl.innerHTML = '';

      memos.forEach(({ time, text }) => {
        const li = document.createElement('li');
        li.textContent = `${time} — ${text}`;
        memosUl.appendChild(li);
      });
    }

    // 日時文字列を「YYYY-MM-DD hh:mm」形式で返す
    function getFormattedNow() {
      const d = new Date();
      const pad = (n) => n.toString().padStart(2, '0');
      return (
        d.getFullYear() +
        '-' +
        pad(d.getMonth() + 1) +
        '-' +
        pad(d.getDate()) +
        ' ' +
        pad(d.getHours()) +
        ':' +
        pad(d.getMinutes())
      );
    }

    // 保存ボタン押下
    saveBtn.addEventListener('click', () => {
      const text = inputEl.value.trim();
      if (!text) {
        alert('メモが空です。何か入力してください。');
        inputEl.focus();
        return;
      }

      const memos = JSON.parse(localStorage.getItem('memos')) || [];
      memos.push({ time: getFormattedNow(), text });
      localStorage.setItem('memos', JSON.stringify(memos));

      inputEl.value = '';
      renderMemos();
    });

    // クリアボタン押下
    clearBtn.addEventListener('click', () => {
      if (confirm('全てのメモを削除します。よろしいですか？')) {
        localStorage.removeItem('memos');
        renderMemos();
      }
    });

    // ページロード時に一覧表示
    document.addEventListener('DOMContentLoaded', renderMemos);
  </script>
</body>
</html>
